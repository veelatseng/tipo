$(function(){document.documentElement.addEventListener("gesturestart",function(e){e.preventDefault()},!1);var e=$(window),i=e.outerWidth(),t=(e.height(),$("body")),n=768;$("html").removeClass("no-js"),$(".navigation ul").length>1&&$(".navigation ul:nth-child(1)").addClass("left_nav"),$(".navigation").has(".language").addClass("have_language");var a=$(".menu");a.find("li").has("ul").addClass("hasChild");var l=a.find("li.hasChild"),s=$(".menu ul").children("li.hasChild"),o=$(".menu ul ul").children("li.hasChild"),c=$(".menu ul ul ul").children("li.hasChild");l.first().children("ul").outerWidth();t.prepend('<aside class="sidebar"><div class="m_area"><button type="button" class="sidebarClose">關閉</button></div><div class="menu_overlay"></div></aside>'),$("header .container").prepend('<button type="button" class="sidebarCtrl">側欄選單</button><button type="button" class="searchCtrl">查詢</button>');var r=$(".sidebar"),h=$(".search"),d=$(".navigation"),u=$(".sidebarClose"),f=$(".sidebarCtrl"),g=$(".menu_overlay");_mArea=$(".m_area"),f.append("<span></span><span></span><span></span>");var m,p=!1;function v(){_mArea.animate({"margin-left":-1*_mArea.width()+"px"},500,"easeOutQuint",function(){r.fadeOut(200),_mArea.hide()}),t.removeClass("noscroll"),g.fadeOut(),l.children("ul").hide()}function b(){(i=e.outerWidth())<n?(!1,r.hide(),g.hide(),d.prependTo(_mArea),a.prependTo(_mArea),h.prependTo(t),h.addClass("m_search"),_mArea.css({"margin-left":-1*_mArea.width()+"px"}),s.on({mouseenter:function(){$(this).children("ul").stop(!0,!0).slideDown("600","easeOutQuint")},mouseleave:function(){$(this).parent().siblings("ul").hide(),$(this).children("ul").stop(!0,!0).slideUp("600","easeOutQuint")}}),l.off().on("mouseenter,mouseleave"),l.on("touchstart",function(){$(this).off("mouseenter,mouseleave")}),s.off().on("click",function(e){$(this).siblings("li").find("ul").stop(!0,!0).slideUp("600","easeOutQuint"),$(this).children("ul").stop(!0,!0).slideDown("600","easeOutQuint")}),o.off().on("click",function(e){$(this).siblings("li").children("ul").stop(!0,!0).slideUp("600","easeOutQuint"),$(this).children("ul").stop(!0,!0).slideDown("600","easeOutQuint")}),c.off().on("click",function(e){e.preventDefault()}),l.children("a").off().on("click",function(e){e.preventDefault()}),t.off("touchmove"),$(".m_search").hide(),$(".language").find("ul").hide()):(v(),t.removeClass("noscroll"),d.prependTo(".header .container"),h.appendTo(".header .container"),a.appendTo(".header .container"),h.removeClass("m_search"),h.show(),p=!1,$(".language").find("ul").hide(),l.on({mouseenter:function(){$(this).children("ul").stop(!0,!1).fadeIn()},mouseleave:function(){$(this).parent().siblings("ul").hide(),$(this).children("ul").stop(!0,!1).fadeOut()}}),l.off("click"),$(document).on("touchend click",function(e){var i=e.target;$(i).is(".menu li a")||$(".menu").find("li ul").hide()}))}f.click(function(e){r.show(),_mArea.show(),_mArea.animate({"margin-left":0},400,"easeOutQuint"),t.addClass("noscroll"),g.fadeIn(),$(".m_search").hide(),p=!1,e.preventDefault()}),g.add(u).off().click(function(){v()}),g.off("mouseenter"),l.keyup(function(){$(this).children("ul").fadeIn(),$(this).siblings().focus(function(){$(this).hide()})}),a.find("li").keyup(function(){$(this).siblings().children("ul").hide()}),a.find("li:last>a").focusout(function(){a.find("li ul").hide()}),e.bind("load resize",function(e){clearTimeout(m),m=setTimeout(function(){p=!0,b()},50)}),b();var y=$(".searchCtrl");$(".m_search").hide(),y.off().on("click",function(e){p?($(".m_search").hide(),p=!1):($(".m_search").stop(!0,!1).slideDown("400","easeOutQuint"),p=!0)}),$(".main").off().on("click touchend",function(e){$(".m_search").hide(),p=!1});var C=$(".header .menu").offset().top;function _(){$(".imgOuter").each(function(e,i){var t,n=$(this),a=n.width(),l=n.height(),s=a/l,o=n.find("img"),c=$(this).find("img").width(),r=$(this).find("img").height();s>c/r?(t=a/c,o.width(a).height(r*t).css("top",-.5*(r*t-l))):(t=l/r,o.height(l).width(c*t).css("left",-.5*(c*t-a))),$(this).find("img").removeClass("img-responsive")})}function _(){$(".imgOuter").each(function(e,i){var t,n=$(this),a=n.width(),l=n.height(),s=a/l,o=n.find("img"),c=$(this).find("img").width(),r=$(this).find("img").height();s>c/r?(t=a/c,o.width(a).height(r*t).css("top",-.5*(r*t-l))):(t=l/r,o.height(l).width(c*t).css("left",-.5*(c*t-a))),$(this).find("img").removeClass("img-responsive")})}$(window).bind("load scroll resize",function(t){(i=e.outerWidth())>=n&&$(this).scrollTop()>C?(hh=Math.floor($(".header").outerHeight(!0)),menuH=Math.floor(a.outerHeight(!0)),$(".header").addClass("fixed"),$(".header").css("margin-top",menuH-hh),$(".main").css("margin-top",hh)):($(".header").removeClass("fixed"),$(".header").css("margin-top",0),$(".main").css("margin-top",0))}),$('[class*="notice"] a.close').click(function(e){$(this).parent('[class*="notice"]').hide(),e.preventDefault()}),$(".accordion").each(function(){$(this).find(".accordion-content").hide(),$(this).children("ul").children("li").children("a").each(function(){function e(e){$(this).parent("li").siblings().children("a").removeClass("active"),$(this).toggleClass("active"),$(this).parent("li").siblings().children(".accordion-content").slideUp(),$(this).next(".accordion-content").slideToggle(),e.preventDefault()}$(this).click(e),$(this).keyup(e)})}),$(".btn-fatfooter").click(function(e){$(this).parent(".container").find("nav>ul>li>ul").stop(!0,!0).slideToggle(function(){$(this).is(":visible")?($(".btn-fatfooter").html("收合/CLOSE"),$(".btn-fatfooter").attr("name","收合選單/CLOSE")):($(".btn-fatfooter").html("展開/OPEN"),$(".btn-fatfooter").attr("name","展開選單/OPEN"))}),$(this).stop(!0,!0).toggleClass("close")}),$(window).bind("resize load",function(e){_()}),_(),$(window).bind("resize load",function(e){_()}),_();$(".gallery").append('<div class="lightbox"><a href="#" class="light_close">關閉</a><a href="#" class="light_prev">上一張</a><a href="#" class="light_next">下一張</a><img src="" alt=""><div class="galler_overlay"></div></div>'),$(".gallery .lightbox").hide(),$(".light_close").click(function(e){$(".gallery .lightbox").hide(),t.removeClass("noscroll"),$(".gallery .lightbox .caption").html(""),!1}),$(".gallery .lightbox .galler_overlay").click(function(e){$(".gallery .lightbox").hide(),t.removeClass("noscroll"),$(".gallery .lightbox .caption").html(""),!1});$(".gallery .lightbox img").attr("src");var k=0;$(".gallery a").click(function(e){e.preventDefault(),!0}),$(".gallery .thumbnail img").each(function(e){$(this).click(function(i){var n=$(this).attr("alt");t.addClass("noscroll"),$(".gallery .lightbox").append('<div class="caption">'+n+"<div>"),THUMB_PIC=$(this).attr("src"),$(".gallery .lightbox img").attr("src",THUMB_PIC),$(".gallery .lightbox").fadeIn(),$(".gallery .lightbox .galler_overlay").fadeIn(),k=e,i.preventDefault()})});var x,w,T=$(".gallery .thumbnail").length;function O(){k+1<T?k++:k=0,THUMB_PIC=$(".gallery .thumbnail img").eq(k).attr("src"),THUMB_H3=$(".gallery .thumbnail img").eq(k).attr("alt"),$(".gallery .lightbox .caption").html(THUMB_H3),$(".gallery .lightbox img").hide(),$(".gallery .lightbox img").fadeIn(),$(".gallery .lightbox img").attr("src",THUMB_PIC)}function D(){k+1>1?k--:k=T-1,THUMB_PIC=$(".gallery .thumbnail img").eq(k).attr("src"),THUMB_H3=$(".gallery .thumbnail img").eq(k).attr("alt"),$(".gallery .lightbox .caption").html(THUMB_H3),$(".gallery .lightbox img").hide(),$(".gallery .lightbox img").fadeIn(),$(".gallery .lightbox img").attr("src",THUMB_PIC)}function H(){$(".tabs").each(function(){var e,t=$(this),a=t.find(".tabItem"),l=a.children("a"),s=t.find(".tabContent"),o=t.width(),c=a.outerHeight(),r=t.find(".active").next().innerHeight(),h=a.length;function d(e){var l=$(this).parent(),s=t.offset().top,o=l.index()/2,h=s+c*o-hh;a.removeClass("active"),l.addClass("active"),i<=n?(a.not(".active").next().slideUp(),l.next().slideDown(),$("html,body").stop(!0,!1).animate({scrollTop:h})):(a.not(".active").next().hide(),l.next().show(),r=l.next().innerHeight(),t.height(r+c)),e.preventDefault()}t.find(".active").next(".tabContent").show(),i>=n?(s.css("top",c),t.height(r+c),e=(o-0*(h-1))/h,a.width(e).css("margin-left",0),a.first().css("margin-left",0),a.last().css({position:"absolute",top:0,right:0}).width(e)):(t.css("height","auto"),a.width(o),a.css("margin-left",0).last().css("position","relative")),l.focus(d),l.click(d)})}$(".gallery .light_next").click(function(e){O(),e.preventDefault()}),$(".gallery .light_prev").click(function(e){D(),e.preventDefault()}),!0&&t.keydown(function(e){37==e.keyCode?D():39==e.keyCode?O():27==e.keyCode&&($(".gallery .lightbox").hide(),$("body").removeClass("noscroll"))}),e.resize(function(){clearTimeout(x),x=setTimeout(function(){i=e.outerWidth(),H()},50)}),$(".tabs>.tabItem:first-child>a").trigger("click"),H(),$(window).bind("scroll",function(){$(this).scrollTop()>200?$(".scrollToTop").fadeIn():$(".scrollToTop").fadeOut()}),$(".scrollToTop").click(function(e){$("html, body").animate({scrollTop:0},800,"easeOutExpo"),e.preventDefault()}),$(".scrollToTop").keydown(function(e){t.find("a:first").focus()}),w=window.navigator.userAgent,/msie|Trident.*rv[ :]*11\./gi.test(w)&&$(".img-container").each(function(){var e=$(this).find("img").attr("src"),i=$(this);i.has(".none").addClass("ie-object-none"),i.has(".none").css("backgroundImage","url("+e+")"),i.has(".cover").addClass("ie-object-cover"),i.has(".cover").css("backgroundImage","url("+e+")"),i.has(".fill").addClass("ie-object-fill"),i.has(".fill").css("backgroundImage","url("+e+")"),i.has(".contain").addClass("ie-object-contain"),i.has(".contain").css("backgroundImage","url("+e+")")}),$("input,textarea").focus(function(){$(this).removeAttr("placeholder")}),$(document).on("change",".check_file",function(){for(var e=[],i=$(this).get(0).files.length,t=0;t<$(this).get(0).files.length;++t)e.push($(this).get(0).files[t].name);if(i>2){e.join(", ");$(this).closest(".upload_grp").find(".upload_file").attr("value",i+" files selected")}else $(this).closest(".upload_grp").find(".upload_file").attr("value",e)}),$(".cp table").each(function(e,i){0!=$(this).parents(".table_list").length&&0!=$(this).parents(".fix_th_table").length||$(this).wrap('<div class="table_wrapper"></div>')}),$(".function_panel .share").children("ul").hide(),$(".function_panel .share").prepend('<a href="#" class="shareButton">share分享按鈕</a>');var I=$(".shareButton");I.off().click(function(e){$(this).siblings("ul").stop(!0,!0).slideToggle(),e.preventDefault()}),I.keyup(function(e){$(this).siblings("ul").stop(!0,!0).slideDown()}),$(".function_panel .share").find("li:last>a").focusout(function(e){$(this).parent().parent("ul").hide()}),$(document).on("touchend click",function(e){var i=$(".function_panel .share");i.is(e.target)||0!==i.has(e.target).length||$(".function_panel .share ul").hide()}),$(".font_size").find(".medium").addClass("active"),$(".font_size").find(".small").click(function(e){$(this).parent("li").siblings("li").find("a").removeClass("active"),$(".cp").removeClass("large_size").addClass("small_size"),$(this).addClass("active"),e.preventDefault()}),$(".font_size").find(".medium").click(function(e){$(this).parent("li").siblings("li").find("a").removeClass("active"),$(".cp").removeClass("large_size small_size"),$(this).addClass("active"),e.preventDefault()}),$(".font_size").find(".large").click(function(e){$(this).parent("li").siblings("li").find("a").removeClass("active"),$(".cp").removeClass("small_size").addClass("large_size"),$(this).addClass("active"),e.preventDefault()}),$(".category").find("a").off().click(function(e){$(this).parent("li").siblings().find("a").removeClass("active"),$(this).addClass("active")}),$(document).on("keydown",function(e){e.altKey&&83==e.keyCode&&($("html, body").animate({scrollTop:0},200,"easeOutExpo"),$(".search").find('input[type="text"]').focus()),e.altKey&&85==e.keyCode&&($("html, body").animate({scrollTop:0},200,"easeOutExpo"),$("header").find(".accesskey").focus()),e.altKey&&67==e.keyCode&&($("html, body").stop(!0,!0).animate({scrollTop:$(".main").find(".accesskey").offset().top},800,"easeOutExpo"),$(".main").find(".accesskey").focus()),e.altKey&&90==e.keyCode&&($("html, body").stop(!0,!0).animate({scrollTop:$("footer").find(".accesskey").offset().top},800,"easeOutExpo"),$("footer").find(".accesskey").focus())}),$("a.goCenter").keydown(function(e){13==e.which&&($("#aC").focus(),$("html, body").stop(!0,!0).animate({scrollTop:$(".main").find(".accesskey").offset().top},800,"easeOutExpo"))}),$(".language").find("ul").hide();var z=$(".language").children("a");z.off().click(function(e){$(this).next("ul").stop(!0,!0).slideToggle(),e.preventDefault()}),z.keyup(function(){$(this).next("ul").stop(!0,!0).slideDown()}),$(".language").find("ul li:last>a").focusout(function(){$(".language").find("ul").hide()}),$(document).on("touchend click",function(e){var i=e.target;$(i).is(".language a")||$(".language").find("ul").hide()})});